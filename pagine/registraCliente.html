<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <title>Registra cliente</title>
  <link rel="stylesheet" href="css/bootstrap.css" />

  <script src="js/gestoreChiamate.js"></script>
  <script src="js/personale.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>

  <script>
    async function registra() {
      let messaggio = document.getElementById("messaggio");
      messaggio.textContent = "";

      let nome = document.getElementById("nome").value.trim();
      let cognome = document.getElementById("cognome").value.trim();
      let email = document.getElementById("email").value.trim();
      let codice = document.getElementById("codice").value.trim();
      let user = document.getElementById("username").value.trim();
      let password = document.getElementById("password").value;

      codice = codice.substring(0, 19);

      let risultato = await registraCliente(nome, cognome, email, codice, user, password);

      if (risultato !== "ok") {
        messaggio.textContent = "Credenziali errate o errore nel login.";
        return;
      }

      window.location.href = "loginCliente.html";
    }
  </script>
</head>
<body class="bg-light">

  <div class="container" style="max-width: 400px; padding: 40px;">
    <h2 class="mb-4 text-center">Registra Cliente</h2>

    <input type="text" id="nome" class="form-control mb-3" placeholder="Nome" />
    <input type="text" id="cognome" class="form-control mb-3" placeholder="Cognome" />
    <input type="text" id="email" class="form-control mb-3" placeholder="Email" />
    <input type="text" id="codice" class="form-control mb-3" placeholder="Codice Identificativo Carta" maxlength="19" />
    <input type="text" id="username" class="form-control mb-3" placeholder="Username" />
    <input type="password" id="password" class="form-control mb-4" placeholder="Password" />

    <button class="btn btn-primary w-100" onclick="registra()">Registra</button>

    <div id="messaggio" class="text-danger mt-3 text-center"></div>
  </div>

</body>
</html>
